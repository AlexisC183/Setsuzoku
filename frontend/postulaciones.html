<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mis Postulaciones - Setsuzoku</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }

        body {
            background-color: #f5f5f5;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .barra-superior {
            background-color: #2c3e50;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            color: #ffffff;
            font-size: 1.5rem;
            font-weight: bold;
            text-decoration: none;
        }

        .contenedor-principal {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .barra-lateral {
            width: 250px;
            background-color: #34495e;
            color: white;
            height: 100%;
            overflow-y: auto;
            position: relative;
            z-index: 100;
        }

        .boton-menu {
            position: absolute;
            top: 10px;
            right: -40px;
            background-color: #34495e;
            color: white;
            border: none;
            border-radius: 0 5px 5px 0;
            padding: 10px;
            cursor: pointer;
            z-index: 101;
        }

        .menu-usuario {
            padding: 20px;
            border-bottom: 1px solid #2c3e50;
        }

        .nombre-usuario {
            font-size: 1.2rem;
            margin-bottom: 5px;
        }

        .rol-usuario {
            font-size: 0.9rem;
            color: #bdc3c7;
        }

        .menu-opciones {
            list-style: none;
            padding: 0;
        }

        .menu-opciones li {
            border-bottom: 1px solid #2c3e50;
        }

        .menu-opciones a {
            display: block;
            padding: 15px 20px;
            color: white;
            text-decoration: none;
            transition: background-color 0.2s;
        }

        .menu-opciones a:hover {
            background-color: #2c3e50;
        }

        .menu-opciones a.disabled {
            color: #7f8c8d;
            cursor: not-allowed;
        }

        .menu-opciones a.disabled:hover {
            background-color: transparent;
        }

        .contenido-postulaciones {
            flex: 1;
            padding: 30px;
            background-color: white;
            margin: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .titulo-postulaciones {
            font-size: 2rem;
            color: #2c3e50;
            margin-bottom: 30px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }

        .lista-postulaciones {
            list-style: none;
        }

        .postulacion-item {
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .postulacion-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .postulacion-titulo {
            font-size: 1.3rem;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .postulacion-empresa {
            font-size: 1rem;
            color: #7f8c8d;
            margin-bottom: 10px;
        }

        .postulacion-estado {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .estado-pendiente {
            background-color: #fff3cd;
            color: #856404;
        }

        .estado-revisado {
            background-color: #d1ecf1;
            color: #0c5460;
        }

        .estado-aceptado {
            background-color: #d4edda;
            color: #155724;
        }

        .estado-rechazado {
            background-color: #f8d7da;
            color: #721c24;
        }

        .postulacion-fecha {
            font-size: 0.9rem;
            color: #95a5a6;
        }

        .mensaje-vacio {
            text-align: center;
            padding: 40px;
            color: #7f8c8d;
        }
    </style>
</head>
<body>
    <!-- BARRA SUPERIOR -->
    <nav class="barra-superior">
        <a href="index.html" class="logo">Setsuzoku</a>
    </nav>

    <div class="contenedor-principal">
        <!-- BARRA LATERAL -->
        <div class="barra-lateral">
            <button class="boton-menu" id="boton-menu">☰</button>

            <div class="menu-usuario">
                <div class="nombre-usuario" id="nombre-usuario">Usuario</div>
                <div class="rol-usuario" id="rol-usuario">Rol</div>
            </div>

            <ul class="menu-opciones">
                <li><a href="perfil.html">Perfil</a></li>
                <li><a href="index.html">Menú principal</a></li>
                <li><a href="postulaciones.html" id="enlace-postulaciones">Tus postulaciones</a></li>
                <li><a href="cursos_usuario.html" id="enlace-cursos-usuario">Tus cursos</a></li>
                <li><a href="trabajos.html" id="enlace-trabajos">Trabajos</a></li>
                <li><a href="cursos.html" id="enlace-cursos">Cursos</a></li>
                <li><a href="#" id="cerrar-sesion">Cerrar sesión</a></li>
            </ul>
        </div>

        <!-- CONTENIDO DE POSTULACIONES -->
        <div class="contenido-postulaciones">
            <h1 class="titulo-postulaciones">Mis Postulaciones</h1>

            <div id="contenedor-postulaciones">
                <!-- Las postulaciones se cargarán aquí con JavaScript -->
            </div>
        </div>
    </div>

    <script>
        // Función para cargar los datos del usuario
        function cargarDatosUsuario() {
            const usuario = JSON.parse(sessionStorage.getItem('usuario'));

            if (usuario) {
                // Mostrar información del usuario en la barra lateral
                document.getElementById('nombre-usuario').textContent = usuario.nombre;
                document.getElementById('rol-usuario').textContent =
                    usuario.grupo.charAt(0).toUpperCase() + usuario.grupo.slice(1);

                // Configurar opciones según el rol
                configurarMenuSegunRol(usuario.grupo);

                // Cargar postulaciones
                cargarPostulaciones(usuario.id);
            } else {
                // Si no hay sesión, redirigir al inicio
                window.location.href = 'index.html';
            }
        }

        // Configurar el menú según el rol del usuario
        function configurarMenuSegunRol(rol) {
            // Por defecto, todos los enlaces están habilitados
            const enlaces = {
                'postulaciones': false,
                'cursos-usuario': false,
                'trabajos': false,
                'cursos': false
            };

            // Configurar según el rol
            switch(rol) {
                case 'candidato':
                    // Los candidatos pueden ver todo excepto "Trabajos" (publicar ofertas)
                    enlaces['trabajos'] = true;
                    break;
                case 'reclutador':
                    // Los reclutadores pueden ver todo excepto "Tus cursos"
                    enlaces['cursos-usuario'] = true;
                    break;
                case 'instructor':
                    // Los instructores pueden ver todo excepto "Tus postulaciones"
                    enlaces['postulaciones'] = true;
                    break;
            }

            // Aplicar la configuración
            for (const [enlace, deshabilitar] of Object.entries(enlaces)) {
                const elemento = document.getElementById(`enlace-${enlace}`);
                if (deshabilitar) {
                    elemento.classList.add('disabled');
                    elemento.setAttribute('href', '#');
                }
            }
        }

        // Función para cargar las postulaciones del usuario
        function cargarPostulaciones(usuarioId) {
            const contenedorPostulaciones = document.getElementById('contenedor-postulaciones');

            // Simulación de datos de postulaciones
            // En una aplicación real, estos datos vendrían de una API o base de datos
            const postulacionesSimuladas = [
                {
                    id: 1,
                    titulo: "Desarrollador Frontend",
                    empresa: "Tech Solutions S.A.",
                    estado: "pendiente",
                    fecha: "2023-05-15"
                },
                {
                    id: 2,
                    titulo: "Diseñador UX/UI",
                    empresa: "Creative Studios",
                    estado: "revisado",
                    fecha: "2023-05-10"
                },
                {
                    id: 3,
                    titulo: "Analista de Datos",
                    empresa: "Data Insights Ltd.",
                    estado: "aceptado",
                    fecha: "2023-05-01"
                }
            ];

            // Verificar si hay postulaciones
            if (postulacionesSimuladas.length === 0) {
                contenedorPostulaciones.innerHTML = '<div class="mensaje-vacio">No tienes postulaciones registradas.</div>';
                return;
            }

            // Crear lista de postulaciones
            const listaPostulaciones = document.createElement('ul');
            listaPostulaciones.className = 'lista-postulaciones';

            // Agregar cada postulación a la lista
            postulacionesSimuladas.forEach(postulacion => {
                const itemPostulacion = document.createElement('li');
                itemPostulacion.className = 'postulacion-item';

                // Determinar clase CSS según el estado
                let claseEstado = '';
                switch(postulacion.estado) {
                    case 'pendiente':
                        claseEstado = 'estado-pendiente';
                        break;
                    case 'revisado':
                        claseEstado = 'estado-revisado';
                        break;
                    case 'aceptado':
                        claseEstado = 'estado-aceptado';
                        break;
                    case 'rechazado':
                        claseEstado = 'estado-rechazado';
                        break;
                }

                // Formatear fecha
                const fecha = new Date(postulacion.fecha);
                const fechaFormateada = fecha.toLocaleDateString('es-ES', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });

                // Construir HTML del item
                itemPostulacion.innerHTML = `
                    <h3 class="postulacion-titulo">${postulacion.titulo}</h3>
                    <p class="postulacion-empresa">${postulacion.empresa}</p>
                    <span class="postulacion-estado ${claseEstado}">${postulacion.estado.charAt(0).toUpperCase() + postulacion.estado.slice(1)}</span>
                    <p class="postulacion-fecha">Postulado el: ${fechaFormateada}</p>
                `;

                listaPostulaciones.appendChild(itemPostulacion);
            });

            // Agregar lista al contenedor
            contenedorPostulaciones.appendChild(listaPostulaciones);
        }

        // Función para cerrar sesión
        function cerrarSesion() {
            // Limpiar sessionStorage
            sessionStorage.removeItem('usuario');
            
            // Forzar recarga completa de la página
            window.location.href = 'index.html';
        }

        // Función para alternar la barra lateral
        function toggleBarraLateral() {
            const barraLateral = document.querySelector('.barra-lateral');
            barraLateral.classList.toggle('abierta');
        }

        // Inicializar la página
        document.addEventListener('DOMContentLoaded', function() {
            // Cargar datos del usuario
            cargarDatosUsuario();

            // Configurar evento para el botón de menú
            document.getElementById('boton-menu').addEventListener('click', toggleBarraLateral);

            // Configurar evento para cerrar sesión
            document.getElementById('cerrar-sesion').addEventListener('click', function(e) {
                e.preventDefault();
                cerrarSesion();
            });
        });
    </script>
</body>
</html>